{"ast":null,"code":"import _asyncToGenerator from \"/Applications/XAMPP/xamppfiles/htdocs/croppers-new/App_code/User-Web-Version/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport Swal from 'sweetalert2';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"./util.service\";\nexport class CartService {\n  constructor(util) {\n    this.util = util;\n    this.cart = [];\n    this.itemId = [];\n    this.totalPrice = 0;\n    this.grandTotal = 0;\n    this.discount = 0;\n    this.orderTax = 0;\n    this.shippingPrice = 0;\n    this.minOrderPrice = 0;\n    this.freeShipping = 0;\n    this.deliveryPrice = 0;\n    this.stores = [];\n    this.userOrderTaxByStores = [];\n    this.walletDiscount = 0;\n    const data = localStorage.getItem('cart');\n\n    if (data && data != null && data != 'null') {\n      const userCart = JSON.parse(data);\n\n      if (userCart && userCart.length > 0) {\n        this.cart = userCart;\n        this.itemId = [...new Set(this.cart.map(item => item.id))];\n        this.calcuate();\n      } else {\n        this.calcuate();\n      }\n    } else {\n      this.calcuate();\n    }\n  }\n\n  clearCartAlert() {\n    var _this = this;\n\n    return new Promise( /*#__PURE__*/function () {\n      var _ref = _asyncToGenerator(function* (resolve, reject) {\n        Swal.fire({\n          title: _this.util.translate('Warning'),\n          text: _this.util.translate(\"You already have item's in cart with different grocery store\"),\n          icon: 'warning',\n          showCancelButton: true,\n          confirmButtonColor: '#3085d6',\n          cancelButtonColor: '#d33',\n          confirmButtonText: _this.util.translate('Clear Cart')\n        }).then(result => {\n          console.log(result);\n\n          if (result.isConfirmed) {\n            _this.clearCart();\n\n            resolve(true);\n          } else {\n            resolve(false);\n          }\n        });\n      });\n\n      return function (_x, _x2) {\n        return _ref.apply(this, arguments);\n      };\n    }());\n  }\n\n  clearCart() {\n    this.cart = [];\n    this.itemId = [];\n    this.totalPrice = 0;\n    this.grandTotal = 0;\n    this.coupon = undefined;\n    this.discount = 0;\n    this.orderPrice = 0;\n    this.datetime = undefined;\n    this.stores = [];\n    this.deliveryAddress = null;\n    this.shippingPrice = 0;\n    this.walletDiscount = 0;\n    this.deliveryPrice = 0;\n    this.util.clearKeys('cart');\n  }\n\n  addItem(item) {\n    console.log('item to adde', item);\n    this.cart.push(item);\n    this.itemId.push(item.id);\n    this.calcuate();\n  }\n\n  addQuantity(quantity, id) {\n    console.log('iddd-->>', id);\n    console.log('quantity', quantity);\n    this.cart.forEach(element => {\n      if (element.id == id) {\n        element.quantiy = quantity;\n      }\n    });\n    this.calcuate();\n  }\n\n  removeItem(id) {\n    console.log('remove this item from cart');\n    console.log('current cart items', this.cart);\n    this.cart = this.cart.filter(x => x.id != id);\n    this.itemId = this.itemId.filter(x => x != id);\n    console.log('===>>>>>>>>>', this.cart);\n    console.log('items===>>>', this.itemId);\n\n    if (this.cart.length) {\n      this.calcuate();\n    } else {\n      this.clearCart();\n    }\n  }\n\n  calcuate() {\n    var _this2 = this;\n\n    this.userOrderTaxByStores = [];\n    let total = 0;\n    this.cart.forEach(element => {\n      if (element && element.discount === 0) {\n        if (element.size === '1' || element.size === 1) {\n          if (element.variations[0].items[element.variant].discount && element.variations[0].items[element.variant].discount !== 0) {\n            total = total + parseFloat(element.variations[0].items[element.variant].discount) * element.quantiy;\n          } else {\n            total = total + parseFloat(element.variations[0].items[element.variant].price) * element.quantiy;\n          }\n        } else {\n          total = total + parseFloat(element.original_price) * element.quantiy;\n        }\n      } else {\n        if (element.size === '1' || element.size === 1) {\n          if (element.variations[0].items[element.variant].discount && element.variations[0].items[element.variant].discount !== 0) {\n            total = total + parseFloat(element.variations[0].items[element.variant].discount) * element.quantiy;\n          } else {\n            total = total + parseFloat(element.variations[0].items[element.variant].price) * element.quantiy;\n          }\n        } else {\n          total = total + parseFloat(element.sell_price) * element.quantiy;\n        }\n      }\n    });\n    console.log('total->', total);\n    this.totalPrice = total;\n\n    if (this.coupon && this.coupon.type) {\n      const min = parseFloat(this.coupon.min);\n\n      if (this.totalPrice >= min) {\n        if (this.coupon && this.coupon.type === 'per') {\n          console.log('per');\n\n          function percentage(num, per) {\n            return num / 100 * per;\n          }\n\n          const totalPrice = percentage(parseFloat(this.totalPrice).toFixed(2), parseFloat(this.coupon.off));\n          console.log('============>>>>>>>>>>>>>>>', totalPrice);\n          this.discount = totalPrice.toFixed(2); // this.grandTotal = (this.totalPrice - parseFloat(this.discount)) + this.orderTax;\n        } else {\n          console.log('currency');\n          this.discount = this.coupon.off; // this.grandTotal = (this.totalPrice - parseFloat(this.discount)) + this.orderTax;\n        }\n      } else {\n        this.discount = 0;\n        this.coupon = null;\n      }\n    } else {\n      this.grandTotal = this.totalPrice + this.orderTax;\n\n      if (this.grandTotal <= this.walletDiscount) {\n        this.walletDiscount = this.grandTotal;\n        this.grandTotal = this.grandTotal - this.walletDiscount;\n      } else {\n        this.grandTotal = this.grandTotal - this.walletDiscount;\n      }\n\n      this.grandTotal = parseFloat(this.grandTotal).toFixed(2);\n    }\n\n    if (this.stores && this.stores.length && this.deliveryAddress && this.deliveryAt === 'home') {\n      console.log('--->>> delivery address===>>>', this.deliveryAddress); // this.deliveryPrice = 0;\n\n      let totalKM = 0;\n      let taxEach = 0;\n      this.stores.forEach( /*#__PURE__*/function () {\n        var _ref2 = _asyncToGenerator(function* (element) {\n          const distance = yield _this2.distanceInKmBetweenEarthCoordinates(_this2.deliveryAddress.lat, _this2.deliveryAddress.lng, element.lat, element.lng);\n          console.log('distance', distance, element);\n          totalKM = totalKM + distance;\n          console.log('total->', element.name, totalKM * _this2.shippingPrice); // const storeCount = this.stores.length + 1;\n\n          taxEach = _this2.orderTax / _this2.stores.length;\n          const extraChargeParam = {\n            store_id: element.uid,\n            distance: distance.toFixed(2),\n            tax: taxEach.toFixed(2),\n            shipping: _this2.shipping,\n            shippingPrice: _this2.shippingPrice\n          };\n          console.log(extraChargeParam);\n\n          _this2.userOrderTaxByStores.push(extraChargeParam);\n        });\n\n        return function (_x3) {\n          return _ref2.apply(this, arguments);\n        };\n      }());\n      console.log('00-->>', this.userOrderTaxByStores);\n      setTimeout(() => {\n        console.log('free', this.freeShipping);\n        console.log('totalprice', this.totalPrice);\n\n        if (this.freeShipping > this.totalPrice) {\n          if (this.shipping === 'km') {\n            const distancePricer = totalKM * this.shippingPrice;\n            console.log('====================> KM price', Math.abs(distancePricer));\n            this.deliveryPrice = Math.floor(distancePricer).toFixed(2);\n\n            if (!this.discount || this.discount === null) {\n              this.discount = 0;\n            }\n\n            this.grandTotal = this.totalPrice - parseFloat(this.discount) + this.orderTax + distancePricer;\n            this.grandTotal = parseFloat(this.grandTotal).toFixed(2);\n\n            if (this.grandTotal <= this.walletDiscount) {\n              this.walletDiscount = this.grandTotal;\n              this.grandTotal = this.grandTotal - this.walletDiscount;\n            } else {\n              this.grandTotal = this.grandTotal - this.walletDiscount;\n            }\n\n            this.grandTotal = parseFloat(this.grandTotal).toFixed(2);\n            console.log('grand total===>>', this.grandTotal); // console.log('deliveryeeeeeeeee', this.deliveryPrice);\n          } else {\n            this.deliveryPrice = this.shippingPrice;\n            console.log('shippppppppp=-======0-00-=-=', this.shippingPrice);\n\n            if (!this.discount || this.discount === null) {\n              this.discount = 0;\n            }\n\n            this.grandTotal = this.totalPrice - parseFloat(this.discount) + this.orderTax + this.shippingPrice;\n            this.grandTotal = parseFloat(this.grandTotal).toFixed(2);\n\n            if (this.grandTotal <= this.walletDiscount) {\n              this.walletDiscount = this.grandTotal;\n              this.grandTotal = this.grandTotal - this.walletDiscount;\n            } else {\n              this.grandTotal = this.grandTotal - this.walletDiscount;\n            }\n\n            this.grandTotal = parseFloat(this.grandTotal).toFixed(2);\n            console.log('grand total===>>', this.grandTotal);\n          }\n        } else {\n          this.deliveryPrice = 0;\n          console.log('discount', this.discount);\n\n          if (!this.discount || this.discount === null) {\n            this.discount = 0;\n          }\n\n          console.log('order tax', this.orderTax);\n          this.grandTotal = this.totalPrice - parseFloat(this.discount) + this.orderTax;\n          this.grandTotal = parseFloat(this.grandTotal).toFixed(2);\n\n          if (this.grandTotal <= this.walletDiscount) {\n            this.walletDiscount = this.grandTotal;\n            this.grandTotal = this.grandTotal - this.walletDiscount;\n          } else {\n            this.grandTotal = this.grandTotal - this.walletDiscount;\n          }\n\n          this.grandTotal = parseFloat(this.grandTotal).toFixed(2);\n          console.log('grand total===>>', this.grandTotal);\n        }\n      }, 1000);\n    } else {\n      console.log('no store,no delivery address, no shipping price valid');\n      let taxEach = 0;\n      this.stores.forEach( /*#__PURE__*/function () {\n        var _ref3 = _asyncToGenerator(function* (element) {\n          taxEach = _this2.orderTax / _this2.stores.length;\n          const extraChargeParam = {\n            store_id: element.uid,\n            distance: 0,\n            tax: taxEach.toFixed(2),\n            shipping: _this2.shipping,\n            shippingPrice: _this2.shippingPrice\n          };\n          console.log(extraChargeParam);\n\n          _this2.userOrderTaxByStores.push(extraChargeParam);\n        });\n\n        return function (_x4) {\n          return _ref3.apply(this, arguments);\n        };\n      }());\n      console.log('extra delivery paarammmmm----<<<', this.userOrderTaxByStores);\n      this.deliveryPrice = 0;\n      this.discount = this.discount === null || this.discount === 0 || !this.discount ? 0 : this.discount;\n      this.grandTotal = this.totalPrice - parseFloat(this.discount) + parseFloat(this.orderTax);\n      this.grandTotal = parseFloat(this.grandTotal).toFixed(2);\n\n      if (this.grandTotal <= this.walletDiscount) {\n        this.walletDiscount = this.grandTotal;\n        this.grandTotal = this.grandTotal - this.walletDiscount;\n      } else {\n        this.grandTotal = this.grandTotal - this.walletDiscount;\n      }\n\n      this.grandTotal = parseFloat(this.grandTotal).toFixed(2);\n      console.log('grand total===>>', this.grandTotal);\n    }\n\n    this.util.setKeys('cart', JSON.stringify(this.cart));\n  }\n\n  checkProductInCart(id) {\n    return this.itemId.includes(id);\n  }\n\n  degreesToRadians(degrees) {\n    return degrees * Math.PI / 180;\n  }\n\n  distanceInKmBetweenEarthCoordinates(lat1, lon1, lat2, lon2) {\n    console.log(lat1, lon1, lat2, lon2);\n    const earthRadiusKm = 6371;\n    const dLat = this.degreesToRadians(lat2 - lat1);\n    const dLon = this.degreesToRadians(lon2 - lon1);\n    lat1 = this.degreesToRadians(lat1);\n    lat2 = this.degreesToRadians(lat2);\n    const a = Math.sin(dLat / 2) * Math.sin(dLat / 2) + Math.sin(dLon / 2) * Math.sin(dLon / 2) * Math.cos(lat1) * Math.cos(lat2);\n    const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));\n    return earthRadiusKm * c;\n  }\n\n}\n\nCartService.ɵfac = function CartService_Factory(t) {\n  return new (t || CartService)(i0.ɵɵinject(i1.UtilService));\n};\n\nCartService.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n  token: CartService,\n  factory: CartService.ɵfac,\n  providedIn: 'root'\n});","map":{"version":3,"sources":["/Applications/XAMPP/xamppfiles/htdocs/croppers-new/App_code/User-Web-Version/src/app/services/cart.service.ts"],"names":["Swal","i0","i1","CartService","constructor","util","cart","itemId","totalPrice","grandTotal","discount","orderTax","shippingPrice","minOrderPrice","freeShipping","deliveryPrice","stores","userOrderTaxByStores","walletDiscount","data","localStorage","getItem","userCart","JSON","parse","length","Set","map","item","id","calcuate","clearCartAlert","Promise","resolve","reject","fire","title","translate","text","icon","showCancelButton","confirmButtonColor","cancelButtonColor","confirmButtonText","then","result","console","log","isConfirmed","clearCart","coupon","undefined","orderPrice","datetime","deliveryAddress","clearKeys","addItem","push","addQuantity","quantity","forEach","element","quantiy","removeItem","filter","x","total","size","variations","items","variant","parseFloat","price","original_price","sell_price","type","min","percentage","num","per","toFixed","off","deliveryAt","totalKM","taxEach","distance","distanceInKmBetweenEarthCoordinates","lat","lng","name","extraChargeParam","store_id","uid","tax","shipping","setTimeout","distancePricer","Math","abs","floor","setKeys","stringify","checkProductInCart","includes","degreesToRadians","degrees","PI","lat1","lon1","lat2","lon2","earthRadiusKm","dLat","dLon","a","sin","cos","c","atan2","sqrt","ɵfac","CartService_Factory","t","ɵɵinject","UtilService","ɵprov","ɵɵdefineInjectable","token","factory","providedIn"],"mappings":";AAAA,OAAOA,IAAP,MAAiB,aAAjB;AACA,OAAO,KAAKC,EAAZ,MAAoB,eAApB;AACA,OAAO,KAAKC,EAAZ,MAAoB,gBAApB;AACA,OAAO,MAAMC,WAAN,CAAkB;AACrBC,EAAAA,WAAW,CAACC,IAAD,EAAO;AACd,SAAKA,IAAL,GAAYA,IAAZ;AACA,SAAKC,IAAL,GAAY,EAAZ;AACA,SAAKC,MAAL,GAAc,EAAd;AACA,SAAKC,UAAL,GAAkB,CAAlB;AACA,SAAKC,UAAL,GAAkB,CAAlB;AACA,SAAKC,QAAL,GAAgB,CAAhB;AACA,SAAKC,QAAL,GAAgB,CAAhB;AACA,SAAKC,aAAL,GAAqB,CAArB;AACA,SAAKC,aAAL,GAAqB,CAArB;AACA,SAAKC,YAAL,GAAoB,CAApB;AACA,SAAKC,aAAL,GAAqB,CAArB;AACA,SAAKC,MAAL,GAAc,EAAd;AACA,SAAKC,oBAAL,GAA4B,EAA5B;AACA,SAAKC,cAAL,GAAsB,CAAtB;AACA,UAAMC,IAAI,GAAGC,YAAY,CAACC,OAAb,CAAqB,MAArB,CAAb;;AACA,QAAIF,IAAI,IAAIA,IAAI,IAAI,IAAhB,IAAwBA,IAAI,IAAI,MAApC,EAA4C;AACxC,YAAMG,QAAQ,GAAGC,IAAI,CAACC,KAAL,CAAWL,IAAX,CAAjB;;AACA,UAAIG,QAAQ,IAAIA,QAAQ,CAACG,MAAT,GAAkB,CAAlC,EAAqC;AACjC,aAAKnB,IAAL,GAAYgB,QAAZ;AACA,aAAKf,MAAL,GAAc,CAAC,GAAG,IAAImB,GAAJ,CAAQ,KAAKpB,IAAL,CAAUqB,GAAV,CAAcC,IAAI,IAAIA,IAAI,CAACC,EAA3B,CAAR,CAAJ,CAAd;AACA,aAAKC,QAAL;AACH,OAJD,MAKK;AACD,aAAKA,QAAL;AACH;AACJ,KAVD,MAWK;AACD,WAAKA,QAAL;AACH;AACJ;;AACDC,EAAAA,cAAc,GAAG;AAAA;;AACb,WAAO,IAAIC,OAAJ;AAAA,mCAAY,WAAOC,OAAP,EAAgBC,MAAhB,EAA2B;AAC1ClC,QAAAA,IAAI,CAACmC,IAAL,CAAU;AACNC,UAAAA,KAAK,EAAE,KAAI,CAAC/B,IAAL,CAAUgC,SAAV,CAAoB,SAApB,CADD;AAENC,UAAAA,IAAI,EAAE,KAAI,CAACjC,IAAL,CAAUgC,SAAV,CAAoB,8DAApB,CAFA;AAGNE,UAAAA,IAAI,EAAE,SAHA;AAINC,UAAAA,gBAAgB,EAAE,IAJZ;AAKNC,UAAAA,kBAAkB,EAAE,SALd;AAMNC,UAAAA,iBAAiB,EAAE,MANb;AAONC,UAAAA,iBAAiB,EAAE,KAAI,CAACtC,IAAL,CAAUgC,SAAV,CAAoB,YAApB;AAPb,SAAV,EAQGO,IARH,CAQSC,MAAD,IAAY;AAChBC,UAAAA,OAAO,CAACC,GAAR,CAAYF,MAAZ;;AACA,cAAIA,MAAM,CAACG,WAAX,EAAwB;AACpB,YAAA,KAAI,CAACC,SAAL;;AACAhB,YAAAA,OAAO,CAAC,IAAD,CAAP;AACH,WAHD,MAIK;AACDA,YAAAA,OAAO,CAAC,KAAD,CAAP;AACH;AACJ,SAjBD;AAkBH,OAnBM;;AAAA;AAAA;AAAA;AAAA,QAAP;AAoBH;;AACDgB,EAAAA,SAAS,GAAG;AACR,SAAK3C,IAAL,GAAY,EAAZ;AACA,SAAKC,MAAL,GAAc,EAAd;AACA,SAAKC,UAAL,GAAkB,CAAlB;AACA,SAAKC,UAAL,GAAkB,CAAlB;AACA,SAAKyC,MAAL,GAAcC,SAAd;AACA,SAAKzC,QAAL,GAAgB,CAAhB;AACA,SAAK0C,UAAL,GAAkB,CAAlB;AACA,SAAKC,QAAL,GAAgBF,SAAhB;AACA,SAAKnC,MAAL,GAAc,EAAd;AACA,SAAKsC,eAAL,GAAuB,IAAvB;AACA,SAAK1C,aAAL,GAAqB,CAArB;AACA,SAAKM,cAAL,GAAsB,CAAtB;AACA,SAAKH,aAAL,GAAqB,CAArB;AACA,SAAKV,IAAL,CAAUkD,SAAV,CAAoB,MAApB;AACH;;AACDC,EAAAA,OAAO,CAAC5B,IAAD,EAAO;AACVkB,IAAAA,OAAO,CAACC,GAAR,CAAY,cAAZ,EAA4BnB,IAA5B;AACA,SAAKtB,IAAL,CAAUmD,IAAV,CAAe7B,IAAf;AACA,SAAKrB,MAAL,CAAYkD,IAAZ,CAAiB7B,IAAI,CAACC,EAAtB;AACA,SAAKC,QAAL;AACH;;AACD4B,EAAAA,WAAW,CAACC,QAAD,EAAW9B,EAAX,EAAe;AACtBiB,IAAAA,OAAO,CAACC,GAAR,CAAY,UAAZ,EAAwBlB,EAAxB;AACAiB,IAAAA,OAAO,CAACC,GAAR,CAAY,UAAZ,EAAwBY,QAAxB;AACA,SAAKrD,IAAL,CAAUsD,OAAV,CAAkBC,OAAO,IAAI;AACzB,UAAIA,OAAO,CAAChC,EAAR,IAAcA,EAAlB,EAAsB;AAClBgC,QAAAA,OAAO,CAACC,OAAR,GAAkBH,QAAlB;AACH;AACJ,KAJD;AAKA,SAAK7B,QAAL;AACH;;AACDiC,EAAAA,UAAU,CAAClC,EAAD,EAAK;AACXiB,IAAAA,OAAO,CAACC,GAAR,CAAY,4BAAZ;AACAD,IAAAA,OAAO,CAACC,GAAR,CAAY,oBAAZ,EAAkC,KAAKzC,IAAvC;AACA,SAAKA,IAAL,GAAY,KAAKA,IAAL,CAAU0D,MAAV,CAAiBC,CAAC,IAAIA,CAAC,CAACpC,EAAF,IAAQA,EAA9B,CAAZ;AACA,SAAKtB,MAAL,GAAc,KAAKA,MAAL,CAAYyD,MAAZ,CAAmBC,CAAC,IAAIA,CAAC,IAAIpC,EAA7B,CAAd;AACAiB,IAAAA,OAAO,CAACC,GAAR,CAAY,cAAZ,EAA4B,KAAKzC,IAAjC;AACAwC,IAAAA,OAAO,CAACC,GAAR,CAAY,aAAZ,EAA2B,KAAKxC,MAAhC;;AACA,QAAI,KAAKD,IAAL,CAAUmB,MAAd,EAAsB;AAClB,WAAKK,QAAL;AACH,KAFD,MAGK;AACD,WAAKmB,SAAL;AACH;AACJ;;AACDnB,EAAAA,QAAQ,GAAG;AAAA;;AACP,SAAKb,oBAAL,GAA4B,EAA5B;AACA,QAAIiD,KAAK,GAAG,CAAZ;AACA,SAAK5D,IAAL,CAAUsD,OAAV,CAAkBC,OAAO,IAAI;AACzB,UAAIA,OAAO,IAAIA,OAAO,CAACnD,QAAR,KAAqB,CAApC,EAAuC;AACnC,YAAImD,OAAO,CAACM,IAAR,KAAiB,GAAjB,IAAwBN,OAAO,CAACM,IAAR,KAAiB,CAA7C,EAAgD;AAC5C,cAAIN,OAAO,CAACO,UAAR,CAAmB,CAAnB,EAAsBC,KAAtB,CAA4BR,OAAO,CAACS,OAApC,EAA6C5D,QAA7C,IAAyDmD,OAAO,CAACO,UAAR,CAAmB,CAAnB,EAAsBC,KAAtB,CAA4BR,OAAO,CAACS,OAApC,EAA6C5D,QAA7C,KAA0D,CAAvH,EAA0H;AACtHwD,YAAAA,KAAK,GAAGA,KAAK,GAAIK,UAAU,CAACV,OAAO,CAACO,UAAR,CAAmB,CAAnB,EAAsBC,KAAtB,CAA4BR,OAAO,CAACS,OAApC,EAA6C5D,QAA9C,CAAV,GAAoEmD,OAAO,CAACC,OAA7F;AACH,WAFD,MAGK;AACDI,YAAAA,KAAK,GAAGA,KAAK,GAAIK,UAAU,CAACV,OAAO,CAACO,UAAR,CAAmB,CAAnB,EAAsBC,KAAtB,CAA4BR,OAAO,CAACS,OAApC,EAA6CE,KAA9C,CAAV,GAAiEX,OAAO,CAACC,OAA1F;AACH;AACJ,SAPD,MAQK;AACDI,UAAAA,KAAK,GAAGA,KAAK,GAAIK,UAAU,CAACV,OAAO,CAACY,cAAT,CAAV,GAAqCZ,OAAO,CAACC,OAA9D;AACH;AACJ,OAZD,MAaK;AACD,YAAID,OAAO,CAACM,IAAR,KAAiB,GAAjB,IAAwBN,OAAO,CAACM,IAAR,KAAiB,CAA7C,EAAgD;AAC5C,cAAIN,OAAO,CAACO,UAAR,CAAmB,CAAnB,EAAsBC,KAAtB,CAA4BR,OAAO,CAACS,OAApC,EAA6C5D,QAA7C,IAAyDmD,OAAO,CAACO,UAAR,CAAmB,CAAnB,EAAsBC,KAAtB,CAA4BR,OAAO,CAACS,OAApC,EAA6C5D,QAA7C,KAA0D,CAAvH,EAA0H;AACtHwD,YAAAA,KAAK,GAAGA,KAAK,GAAIK,UAAU,CAACV,OAAO,CAACO,UAAR,CAAmB,CAAnB,EAAsBC,KAAtB,CAA4BR,OAAO,CAACS,OAApC,EAA6C5D,QAA9C,CAAV,GAAoEmD,OAAO,CAACC,OAA7F;AACH,WAFD,MAGK;AACDI,YAAAA,KAAK,GAAGA,KAAK,GAAIK,UAAU,CAACV,OAAO,CAACO,UAAR,CAAmB,CAAnB,EAAsBC,KAAtB,CAA4BR,OAAO,CAACS,OAApC,EAA6CE,KAA9C,CAAV,GAAiEX,OAAO,CAACC,OAA1F;AACH;AACJ,SAPD,MAQK;AACDI,UAAAA,KAAK,GAAGA,KAAK,GAAIK,UAAU,CAACV,OAAO,CAACa,UAAT,CAAV,GAAiCb,OAAO,CAACC,OAA1D;AACH;AACJ;AACJ,KA3BD;AA4BAhB,IAAAA,OAAO,CAACC,GAAR,CAAY,SAAZ,EAAuBmB,KAAvB;AACA,SAAK1D,UAAL,GAAkB0D,KAAlB;;AACA,QAAI,KAAKhB,MAAL,IAAe,KAAKA,MAAL,CAAYyB,IAA/B,EAAqC;AACjC,YAAMC,GAAG,GAAGL,UAAU,CAAC,KAAKrB,MAAL,CAAY0B,GAAb,CAAtB;;AACA,UAAI,KAAKpE,UAAL,IAAmBoE,GAAvB,EAA4B;AACxB,YAAI,KAAK1B,MAAL,IAAe,KAAKA,MAAL,CAAYyB,IAAZ,KAAqB,KAAxC,EAA+C;AAC3C7B,UAAAA,OAAO,CAACC,GAAR,CAAY,KAAZ;;AACA,mBAAS8B,UAAT,CAAoBC,GAApB,EAAyBC,GAAzB,EAA8B;AAC1B,mBAAQD,GAAG,GAAG,GAAP,GAAcC,GAArB;AACH;;AACD,gBAAMvE,UAAU,GAAGqE,UAAU,CAACN,UAAU,CAAC,KAAK/D,UAAN,CAAV,CAA4BwE,OAA5B,CAAoC,CAApC,CAAD,EAAyCT,UAAU,CAAC,KAAKrB,MAAL,CAAY+B,GAAb,CAAnD,CAA7B;AACAnC,UAAAA,OAAO,CAACC,GAAR,CAAY,6BAAZ,EAA2CvC,UAA3C;AACA,eAAKE,QAAL,GAAgBF,UAAU,CAACwE,OAAX,CAAmB,CAAnB,CAAhB,CAP2C,CAQ3C;AACH,SATD,MAUK;AACDlC,UAAAA,OAAO,CAACC,GAAR,CAAY,UAAZ;AACA,eAAKrC,QAAL,GAAgB,KAAKwC,MAAL,CAAY+B,GAA5B,CAFC,CAGD;AACH;AACJ,OAhBD,MAiBK;AACD,aAAKvE,QAAL,GAAgB,CAAhB;AACA,aAAKwC,MAAL,GAAc,IAAd;AACH;AACJ,KAvBD,MAwBK;AACD,WAAKzC,UAAL,GAAkB,KAAKD,UAAL,GAAkB,KAAKG,QAAzC;;AACA,UAAI,KAAKF,UAAL,IAAmB,KAAKS,cAA5B,EAA4C;AACxC,aAAKA,cAAL,GAAsB,KAAKT,UAA3B;AACA,aAAKA,UAAL,GAAkB,KAAKA,UAAL,GAAkB,KAAKS,cAAzC;AACH,OAHD,MAIK;AACD,aAAKT,UAAL,GAAkB,KAAKA,UAAL,GAAkB,KAAKS,cAAzC;AACH;;AACD,WAAKT,UAAL,GAAkB8D,UAAU,CAAC,KAAK9D,UAAN,CAAV,CAA4BuE,OAA5B,CAAoC,CAApC,CAAlB;AACH;;AACD,QAAI,KAAKhE,MAAL,IAAe,KAAKA,MAAL,CAAYS,MAA3B,IAAqC,KAAK6B,eAA1C,IAA6D,KAAK4B,UAAL,KAAoB,MAArF,EAA6F;AACzFpC,MAAAA,OAAO,CAACC,GAAR,CAAY,+BAAZ,EAA6C,KAAKO,eAAlD,EADyF,CAEzF;;AACA,UAAI6B,OAAO,GAAG,CAAd;AACA,UAAIC,OAAO,GAAG,CAAd;AACA,WAAKpE,MAAL,CAAY4C,OAAZ;AAAA,sCAAoB,WAAOC,OAAP,EAAmB;AACnC,gBAAMwB,QAAQ,SAAS,MAAI,CAACC,mCAAL,CAAyC,MAAI,CAAChC,eAAL,CAAqBiC,GAA9D,EAAmE,MAAI,CAACjC,eAAL,CAAqBkC,GAAxF,EAA6F3B,OAAO,CAAC0B,GAArG,EAA0G1B,OAAO,CAAC2B,GAAlH,CAAvB;AACA1C,UAAAA,OAAO,CAACC,GAAR,CAAY,UAAZ,EAAwBsC,QAAxB,EAAkCxB,OAAlC;AACAsB,UAAAA,OAAO,GAAGA,OAAO,GAAGE,QAApB;AACAvC,UAAAA,OAAO,CAACC,GAAR,CAAY,SAAZ,EAAuBc,OAAO,CAAC4B,IAA/B,EAAqCN,OAAO,GAAG,MAAI,CAACvE,aAApD,EAJmC,CAKnC;;AACAwE,UAAAA,OAAO,GAAG,MAAI,CAACzE,QAAL,GAAgB,MAAI,CAACK,MAAL,CAAYS,MAAtC;AACA,gBAAMiE,gBAAgB,GAAG;AACrBC,YAAAA,QAAQ,EAAE9B,OAAO,CAAC+B,GADG;AAErBP,YAAAA,QAAQ,EAAEA,QAAQ,CAACL,OAAT,CAAiB,CAAjB,CAFW;AAGrBa,YAAAA,GAAG,EAAET,OAAO,CAACJ,OAAR,CAAgB,CAAhB,CAHgB;AAIrBc,YAAAA,QAAQ,EAAE,MAAI,CAACA,QAJM;AAKrBlF,YAAAA,aAAa,EAAE,MAAI,CAACA;AALC,WAAzB;AAOAkC,UAAAA,OAAO,CAACC,GAAR,CAAY2C,gBAAZ;;AACA,UAAA,MAAI,CAACzE,oBAAL,CAA0BwC,IAA1B,CAA+BiC,gBAA/B;AACH,SAhBD;;AAAA;AAAA;AAAA;AAAA;AAiBA5C,MAAAA,OAAO,CAACC,GAAR,CAAY,QAAZ,EAAsB,KAAK9B,oBAA3B;AACA8E,MAAAA,UAAU,CAAC,MAAM;AACbjD,QAAAA,OAAO,CAACC,GAAR,CAAY,MAAZ,EAAoB,KAAKjC,YAAzB;AACAgC,QAAAA,OAAO,CAACC,GAAR,CAAY,YAAZ,EAA0B,KAAKvC,UAA/B;;AACA,YAAI,KAAKM,YAAL,GAAoB,KAAKN,UAA7B,EAAyC;AACrC,cAAI,KAAKsF,QAAL,KAAkB,IAAtB,EAA4B;AACxB,kBAAME,cAAc,GAAGb,OAAO,GAAG,KAAKvE,aAAtC;AACAkC,YAAAA,OAAO,CAACC,GAAR,CAAY,gCAAZ,EAA8CkD,IAAI,CAACC,GAAL,CAASF,cAAT,CAA9C;AACA,iBAAKjF,aAAL,GAAqBkF,IAAI,CAACE,KAAL,CAAWH,cAAX,EAA2BhB,OAA3B,CAAmC,CAAnC,CAArB;;AACA,gBAAI,CAAC,KAAKtE,QAAN,IAAkB,KAAKA,QAAL,KAAkB,IAAxC,EAA8C;AAC1C,mBAAKA,QAAL,GAAgB,CAAhB;AACH;;AACD,iBAAKD,UAAL,GAAmB,KAAKD,UAAL,GAAkB+D,UAAU,CAAC,KAAK7D,QAAN,CAA7B,GAAgD,KAAKC,QAArD,GAAgEqF,cAAlF;AACA,iBAAKvF,UAAL,GAAkB8D,UAAU,CAAC,KAAK9D,UAAN,CAAV,CAA4BuE,OAA5B,CAAoC,CAApC,CAAlB;;AACA,gBAAI,KAAKvE,UAAL,IAAmB,KAAKS,cAA5B,EAA4C;AACxC,mBAAKA,cAAL,GAAsB,KAAKT,UAA3B;AACA,mBAAKA,UAAL,GAAkB,KAAKA,UAAL,GAAkB,KAAKS,cAAzC;AACH,aAHD,MAIK;AACD,mBAAKT,UAAL,GAAkB,KAAKA,UAAL,GAAkB,KAAKS,cAAzC;AACH;;AACD,iBAAKT,UAAL,GAAkB8D,UAAU,CAAC,KAAK9D,UAAN,CAAV,CAA4BuE,OAA5B,CAAoC,CAApC,CAAlB;AACAlC,YAAAA,OAAO,CAACC,GAAR,CAAY,kBAAZ,EAAgC,KAAKtC,UAArC,EAjBwB,CAkBxB;AACH,WAnBD,MAoBK;AACD,iBAAKM,aAAL,GAAqB,KAAKH,aAA1B;AACAkC,YAAAA,OAAO,CAACC,GAAR,CAAY,8BAAZ,EAA4C,KAAKnC,aAAjD;;AACA,gBAAI,CAAC,KAAKF,QAAN,IAAkB,KAAKA,QAAL,KAAkB,IAAxC,EAA8C;AAC1C,mBAAKA,QAAL,GAAgB,CAAhB;AACH;;AACD,iBAAKD,UAAL,GAAmB,KAAKD,UAAL,GAAkB+D,UAAU,CAAC,KAAK7D,QAAN,CAA7B,GAAgD,KAAKC,QAArD,GAAgE,KAAKC,aAAvF;AACA,iBAAKH,UAAL,GAAkB8D,UAAU,CAAC,KAAK9D,UAAN,CAAV,CAA4BuE,OAA5B,CAAoC,CAApC,CAAlB;;AACA,gBAAI,KAAKvE,UAAL,IAAmB,KAAKS,cAA5B,EAA4C;AACxC,mBAAKA,cAAL,GAAsB,KAAKT,UAA3B;AACA,mBAAKA,UAAL,GAAkB,KAAKA,UAAL,GAAkB,KAAKS,cAAzC;AACH,aAHD,MAIK;AACD,mBAAKT,UAAL,GAAkB,KAAKA,UAAL,GAAkB,KAAKS,cAAzC;AACH;;AACD,iBAAKT,UAAL,GAAkB8D,UAAU,CAAC,KAAK9D,UAAN,CAAV,CAA4BuE,OAA5B,CAAoC,CAApC,CAAlB;AACAlC,YAAAA,OAAO,CAACC,GAAR,CAAY,kBAAZ,EAAgC,KAAKtC,UAArC;AACH;AACJ,SAvCD,MAwCK;AACD,eAAKM,aAAL,GAAqB,CAArB;AACA+B,UAAAA,OAAO,CAACC,GAAR,CAAY,UAAZ,EAAwB,KAAKrC,QAA7B;;AACA,cAAI,CAAC,KAAKA,QAAN,IAAkB,KAAKA,QAAL,KAAkB,IAAxC,EAA8C;AAC1C,iBAAKA,QAAL,GAAgB,CAAhB;AACH;;AACDoC,UAAAA,OAAO,CAACC,GAAR,CAAY,WAAZ,EAAyB,KAAKpC,QAA9B;AACA,eAAKF,UAAL,GAAmB,KAAKD,UAAL,GAAkB+D,UAAU,CAAC,KAAK7D,QAAN,CAA7B,GAAgD,KAAKC,QAAvE;AACA,eAAKF,UAAL,GAAkB8D,UAAU,CAAC,KAAK9D,UAAN,CAAV,CAA4BuE,OAA5B,CAAoC,CAApC,CAAlB;;AACA,cAAI,KAAKvE,UAAL,IAAmB,KAAKS,cAA5B,EAA4C;AACxC,iBAAKA,cAAL,GAAsB,KAAKT,UAA3B;AACA,iBAAKA,UAAL,GAAkB,KAAKA,UAAL,GAAkB,KAAKS,cAAzC;AACH,WAHD,MAIK;AACD,iBAAKT,UAAL,GAAkB,KAAKA,UAAL,GAAkB,KAAKS,cAAzC;AACH;;AACD,eAAKT,UAAL,GAAkB8D,UAAU,CAAC,KAAK9D,UAAN,CAAV,CAA4BuE,OAA5B,CAAoC,CAApC,CAAlB;AACAlC,UAAAA,OAAO,CAACC,GAAR,CAAY,kBAAZ,EAAgC,KAAKtC,UAArC;AACH;AACJ,OA9DS,EA8DP,IA9DO,CAAV;AA+DH,KAtFD,MAuFK;AACDqC,MAAAA,OAAO,CAACC,GAAR,CAAY,uDAAZ;AACA,UAAIqC,OAAO,GAAG,CAAd;AACA,WAAKpE,MAAL,CAAY4C,OAAZ;AAAA,sCAAoB,WAAOC,OAAP,EAAmB;AACnCuB,UAAAA,OAAO,GAAG,MAAI,CAACzE,QAAL,GAAgB,MAAI,CAACK,MAAL,CAAYS,MAAtC;AACA,gBAAMiE,gBAAgB,GAAG;AACrBC,YAAAA,QAAQ,EAAE9B,OAAO,CAAC+B,GADG;AAErBP,YAAAA,QAAQ,EAAE,CAFW;AAGrBQ,YAAAA,GAAG,EAAET,OAAO,CAACJ,OAAR,CAAgB,CAAhB,CAHgB;AAIrBc,YAAAA,QAAQ,EAAE,MAAI,CAACA,QAJM;AAKrBlF,YAAAA,aAAa,EAAE,MAAI,CAACA;AALC,WAAzB;AAOAkC,UAAAA,OAAO,CAACC,GAAR,CAAY2C,gBAAZ;;AACA,UAAA,MAAI,CAACzE,oBAAL,CAA0BwC,IAA1B,CAA+BiC,gBAA/B;AACH,SAXD;;AAAA;AAAA;AAAA;AAAA;AAYA5C,MAAAA,OAAO,CAACC,GAAR,CAAY,kCAAZ,EAAgD,KAAK9B,oBAArD;AACA,WAAKF,aAAL,GAAqB,CAArB;AACA,WAAKL,QAAL,GAAgB,KAAKA,QAAL,KAAkB,IAAlB,IAA0B,KAAKA,QAAL,KAAkB,CAA5C,IAAiD,CAAC,KAAKA,QAAvD,GAAkE,CAAlE,GAAsE,KAAKA,QAA3F;AACA,WAAKD,UAAL,GAAmB,KAAKD,UAAL,GAAkB+D,UAAU,CAAC,KAAK7D,QAAN,CAA7B,GAAgD6D,UAAU,CAAC,KAAK5D,QAAN,CAA5E;AACA,WAAKF,UAAL,GAAkB8D,UAAU,CAAC,KAAK9D,UAAN,CAAV,CAA4BuE,OAA5B,CAAoC,CAApC,CAAlB;;AACA,UAAI,KAAKvE,UAAL,IAAmB,KAAKS,cAA5B,EAA4C;AACxC,aAAKA,cAAL,GAAsB,KAAKT,UAA3B;AACA,aAAKA,UAAL,GAAkB,KAAKA,UAAL,GAAkB,KAAKS,cAAzC;AACH,OAHD,MAIK;AACD,aAAKT,UAAL,GAAkB,KAAKA,UAAL,GAAkB,KAAKS,cAAzC;AACH;;AACD,WAAKT,UAAL,GAAkB8D,UAAU,CAAC,KAAK9D,UAAN,CAAV,CAA4BuE,OAA5B,CAAoC,CAApC,CAAlB;AACAlC,MAAAA,OAAO,CAACC,GAAR,CAAY,kBAAZ,EAAgC,KAAKtC,UAArC;AACH;;AACD,SAAKJ,IAAL,CAAU+F,OAAV,CAAkB,MAAlB,EAA0B7E,IAAI,CAAC8E,SAAL,CAAe,KAAK/F,IAApB,CAA1B;AACH;;AACDgG,EAAAA,kBAAkB,CAACzE,EAAD,EAAK;AACnB,WAAO,KAAKtB,MAAL,CAAYgG,QAAZ,CAAqB1E,EAArB,CAAP;AACH;;AACD2E,EAAAA,gBAAgB,CAACC,OAAD,EAAU;AACtB,WAAOA,OAAO,GAAGR,IAAI,CAACS,EAAf,GAAoB,GAA3B;AACH;;AACDpB,EAAAA,mCAAmC,CAACqB,IAAD,EAAOC,IAAP,EAAaC,IAAb,EAAmBC,IAAnB,EAAyB;AACxDhE,IAAAA,OAAO,CAACC,GAAR,CAAY4D,IAAZ,EAAkBC,IAAlB,EAAwBC,IAAxB,EAA8BC,IAA9B;AACA,UAAMC,aAAa,GAAG,IAAtB;AACA,UAAMC,IAAI,GAAG,KAAKR,gBAAL,CAAsBK,IAAI,GAAGF,IAA7B,CAAb;AACA,UAAMM,IAAI,GAAG,KAAKT,gBAAL,CAAsBM,IAAI,GAAGF,IAA7B,CAAb;AACAD,IAAAA,IAAI,GAAG,KAAKH,gBAAL,CAAsBG,IAAtB,CAAP;AACAE,IAAAA,IAAI,GAAG,KAAKL,gBAAL,CAAsBK,IAAtB,CAAP;AACA,UAAMK,CAAC,GAAGjB,IAAI,CAACkB,GAAL,CAASH,IAAI,GAAG,CAAhB,IAAqBf,IAAI,CAACkB,GAAL,CAASH,IAAI,GAAG,CAAhB,CAArB,GACNf,IAAI,CAACkB,GAAL,CAASF,IAAI,GAAG,CAAhB,IAAqBhB,IAAI,CAACkB,GAAL,CAASF,IAAI,GAAG,CAAhB,CAArB,GAA0ChB,IAAI,CAACmB,GAAL,CAAST,IAAT,CAA1C,GAA2DV,IAAI,CAACmB,GAAL,CAASP,IAAT,CAD/D;AAEA,UAAMQ,CAAC,GAAG,IAAIpB,IAAI,CAACqB,KAAL,CAAWrB,IAAI,CAACsB,IAAL,CAAUL,CAAV,CAAX,EAAyBjB,IAAI,CAACsB,IAAL,CAAU,IAAIL,CAAd,CAAzB,CAAd;AACA,WAAOH,aAAa,GAAGM,CAAvB;AACH;;AAhToB;;AAkTzBlH,WAAW,CAACqH,IAAZ,GAAmB,SAASC,mBAAT,CAA6BC,CAA7B,EAAgC;AAAE,SAAO,KAAKA,CAAC,IAAIvH,WAAV,EAAuBF,EAAE,CAAC0H,QAAH,CAAYzH,EAAE,CAAC0H,WAAf,CAAvB,CAAP;AAA6D,CAAlH;;AACAzH,WAAW,CAAC0H,KAAZ,GAAoB,aAAc5H,EAAE,CAAC6H,kBAAH,CAAsB;AAAEC,EAAAA,KAAK,EAAE5H,WAAT;AAAsB6H,EAAAA,OAAO,EAAE7H,WAAW,CAACqH,IAA3C;AAAiDS,EAAAA,UAAU,EAAE;AAA7D,CAAtB,CAAlC","sourcesContent":["import Swal from 'sweetalert2';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"./util.service\";\nexport class CartService {\n    constructor(util) {\n        this.util = util;\n        this.cart = [];\n        this.itemId = [];\n        this.totalPrice = 0;\n        this.grandTotal = 0;\n        this.discount = 0;\n        this.orderTax = 0;\n        this.shippingPrice = 0;\n        this.minOrderPrice = 0;\n        this.freeShipping = 0;\n        this.deliveryPrice = 0;\n        this.stores = [];\n        this.userOrderTaxByStores = [];\n        this.walletDiscount = 0;\n        const data = localStorage.getItem('cart');\n        if (data && data != null && data != 'null') {\n            const userCart = JSON.parse(data);\n            if (userCart && userCart.length > 0) {\n                this.cart = userCart;\n                this.itemId = [...new Set(this.cart.map(item => item.id))];\n                this.calcuate();\n            }\n            else {\n                this.calcuate();\n            }\n        }\n        else {\n            this.calcuate();\n        }\n    }\n    clearCartAlert() {\n        return new Promise(async (resolve, reject) => {\n            Swal.fire({\n                title: this.util.translate('Warning'),\n                text: this.util.translate(\"You already have item's in cart with different grocery store\"),\n                icon: 'warning',\n                showCancelButton: true,\n                confirmButtonColor: '#3085d6',\n                cancelButtonColor: '#d33',\n                confirmButtonText: this.util.translate('Clear Cart')\n            }).then((result) => {\n                console.log(result);\n                if (result.isConfirmed) {\n                    this.clearCart();\n                    resolve(true);\n                }\n                else {\n                    resolve(false);\n                }\n            });\n        });\n    }\n    clearCart() {\n        this.cart = [];\n        this.itemId = [];\n        this.totalPrice = 0;\n        this.grandTotal = 0;\n        this.coupon = undefined;\n        this.discount = 0;\n        this.orderPrice = 0;\n        this.datetime = undefined;\n        this.stores = [];\n        this.deliveryAddress = null;\n        this.shippingPrice = 0;\n        this.walletDiscount = 0;\n        this.deliveryPrice = 0;\n        this.util.clearKeys('cart');\n    }\n    addItem(item) {\n        console.log('item to adde', item);\n        this.cart.push(item);\n        this.itemId.push(item.id);\n        this.calcuate();\n    }\n    addQuantity(quantity, id) {\n        console.log('iddd-->>', id);\n        console.log('quantity', quantity);\n        this.cart.forEach(element => {\n            if (element.id == id) {\n                element.quantiy = quantity;\n            }\n        });\n        this.calcuate();\n    }\n    removeItem(id) {\n        console.log('remove this item from cart');\n        console.log('current cart items', this.cart);\n        this.cart = this.cart.filter(x => x.id != id);\n        this.itemId = this.itemId.filter(x => x != id);\n        console.log('===>>>>>>>>>', this.cart);\n        console.log('items===>>>', this.itemId);\n        if (this.cart.length) {\n            this.calcuate();\n        }\n        else {\n            this.clearCart();\n        }\n    }\n    calcuate() {\n        this.userOrderTaxByStores = [];\n        let total = 0;\n        this.cart.forEach(element => {\n            if (element && element.discount === 0) {\n                if (element.size === '1' || element.size === 1) {\n                    if (element.variations[0].items[element.variant].discount && element.variations[0].items[element.variant].discount !== 0) {\n                        total = total + (parseFloat(element.variations[0].items[element.variant].discount) * element.quantiy);\n                    }\n                    else {\n                        total = total + (parseFloat(element.variations[0].items[element.variant].price) * element.quantiy);\n                    }\n                }\n                else {\n                    total = total + (parseFloat(element.original_price) * element.quantiy);\n                }\n            }\n            else {\n                if (element.size === '1' || element.size === 1) {\n                    if (element.variations[0].items[element.variant].discount && element.variations[0].items[element.variant].discount !== 0) {\n                        total = total + (parseFloat(element.variations[0].items[element.variant].discount) * element.quantiy);\n                    }\n                    else {\n                        total = total + (parseFloat(element.variations[0].items[element.variant].price) * element.quantiy);\n                    }\n                }\n                else {\n                    total = total + (parseFloat(element.sell_price) * element.quantiy);\n                }\n            }\n        });\n        console.log('total->', total);\n        this.totalPrice = total;\n        if (this.coupon && this.coupon.type) {\n            const min = parseFloat(this.coupon.min);\n            if (this.totalPrice >= min) {\n                if (this.coupon && this.coupon.type === 'per') {\n                    console.log('per');\n                    function percentage(num, per) {\n                        return (num / 100) * per;\n                    }\n                    const totalPrice = percentage(parseFloat(this.totalPrice).toFixed(2), parseFloat(this.coupon.off));\n                    console.log('============>>>>>>>>>>>>>>>', totalPrice);\n                    this.discount = totalPrice.toFixed(2);\n                    // this.grandTotal = (this.totalPrice - parseFloat(this.discount)) + this.orderTax;\n                }\n                else {\n                    console.log('currency');\n                    this.discount = this.coupon.off;\n                    // this.grandTotal = (this.totalPrice - parseFloat(this.discount)) + this.orderTax;\n                }\n            }\n            else {\n                this.discount = 0;\n                this.coupon = null;\n            }\n        }\n        else {\n            this.grandTotal = this.totalPrice + this.orderTax;\n            if (this.grandTotal <= this.walletDiscount) {\n                this.walletDiscount = this.grandTotal;\n                this.grandTotal = this.grandTotal - this.walletDiscount;\n            }\n            else {\n                this.grandTotal = this.grandTotal - this.walletDiscount;\n            }\n            this.grandTotal = parseFloat(this.grandTotal).toFixed(2);\n        }\n        if (this.stores && this.stores.length && this.deliveryAddress && this.deliveryAt === 'home') {\n            console.log('--->>> delivery address===>>>', this.deliveryAddress);\n            // this.deliveryPrice = 0;\n            let totalKM = 0;\n            let taxEach = 0;\n            this.stores.forEach(async (element) => {\n                const distance = await this.distanceInKmBetweenEarthCoordinates(this.deliveryAddress.lat, this.deliveryAddress.lng, element.lat, element.lng);\n                console.log('distance', distance, element);\n                totalKM = totalKM + distance;\n                console.log('total->', element.name, totalKM * this.shippingPrice);\n                // const storeCount = this.stores.length + 1;\n                taxEach = this.orderTax / this.stores.length;\n                const extraChargeParam = {\n                    store_id: element.uid,\n                    distance: distance.toFixed(2),\n                    tax: taxEach.toFixed(2),\n                    shipping: this.shipping,\n                    shippingPrice: this.shippingPrice\n                };\n                console.log(extraChargeParam);\n                this.userOrderTaxByStores.push(extraChargeParam);\n            });\n            console.log('00-->>', this.userOrderTaxByStores);\n            setTimeout(() => {\n                console.log('free', this.freeShipping);\n                console.log('totalprice', this.totalPrice);\n                if (this.freeShipping > this.totalPrice) {\n                    if (this.shipping === 'km') {\n                        const distancePricer = totalKM * this.shippingPrice;\n                        console.log('====================> KM price', Math.abs(distancePricer));\n                        this.deliveryPrice = Math.floor(distancePricer).toFixed(2);\n                        if (!this.discount || this.discount === null) {\n                            this.discount = 0;\n                        }\n                        this.grandTotal = (this.totalPrice - parseFloat(this.discount)) + this.orderTax + distancePricer;\n                        this.grandTotal = parseFloat(this.grandTotal).toFixed(2);\n                        if (this.grandTotal <= this.walletDiscount) {\n                            this.walletDiscount = this.grandTotal;\n                            this.grandTotal = this.grandTotal - this.walletDiscount;\n                        }\n                        else {\n                            this.grandTotal = this.grandTotal - this.walletDiscount;\n                        }\n                        this.grandTotal = parseFloat(this.grandTotal).toFixed(2);\n                        console.log('grand total===>>', this.grandTotal);\n                        // console.log('deliveryeeeeeeeee', this.deliveryPrice);\n                    }\n                    else {\n                        this.deliveryPrice = this.shippingPrice;\n                        console.log('shippppppppp=-======0-00-=-=', this.shippingPrice);\n                        if (!this.discount || this.discount === null) {\n                            this.discount = 0;\n                        }\n                        this.grandTotal = (this.totalPrice - parseFloat(this.discount)) + this.orderTax + this.shippingPrice;\n                        this.grandTotal = parseFloat(this.grandTotal).toFixed(2);\n                        if (this.grandTotal <= this.walletDiscount) {\n                            this.walletDiscount = this.grandTotal;\n                            this.grandTotal = this.grandTotal - this.walletDiscount;\n                        }\n                        else {\n                            this.grandTotal = this.grandTotal - this.walletDiscount;\n                        }\n                        this.grandTotal = parseFloat(this.grandTotal).toFixed(2);\n                        console.log('grand total===>>', this.grandTotal);\n                    }\n                }\n                else {\n                    this.deliveryPrice = 0;\n                    console.log('discount', this.discount);\n                    if (!this.discount || this.discount === null) {\n                        this.discount = 0;\n                    }\n                    console.log('order tax', this.orderTax);\n                    this.grandTotal = (this.totalPrice - parseFloat(this.discount)) + this.orderTax;\n                    this.grandTotal = parseFloat(this.grandTotal).toFixed(2);\n                    if (this.grandTotal <= this.walletDiscount) {\n                        this.walletDiscount = this.grandTotal;\n                        this.grandTotal = this.grandTotal - this.walletDiscount;\n                    }\n                    else {\n                        this.grandTotal = this.grandTotal - this.walletDiscount;\n                    }\n                    this.grandTotal = parseFloat(this.grandTotal).toFixed(2);\n                    console.log('grand total===>>', this.grandTotal);\n                }\n            }, 1000);\n        }\n        else {\n            console.log('no store,no delivery address, no shipping price valid');\n            let taxEach = 0;\n            this.stores.forEach(async (element) => {\n                taxEach = this.orderTax / this.stores.length;\n                const extraChargeParam = {\n                    store_id: element.uid,\n                    distance: 0,\n                    tax: taxEach.toFixed(2),\n                    shipping: this.shipping,\n                    shippingPrice: this.shippingPrice\n                };\n                console.log(extraChargeParam);\n                this.userOrderTaxByStores.push(extraChargeParam);\n            });\n            console.log('extra delivery paarammmmm----<<<', this.userOrderTaxByStores);\n            this.deliveryPrice = 0;\n            this.discount = this.discount === null || this.discount === 0 || !this.discount ? 0 : this.discount;\n            this.grandTotal = (this.totalPrice - parseFloat(this.discount)) + parseFloat(this.orderTax);\n            this.grandTotal = parseFloat(this.grandTotal).toFixed(2);\n            if (this.grandTotal <= this.walletDiscount) {\n                this.walletDiscount = this.grandTotal;\n                this.grandTotal = this.grandTotal - this.walletDiscount;\n            }\n            else {\n                this.grandTotal = this.grandTotal - this.walletDiscount;\n            }\n            this.grandTotal = parseFloat(this.grandTotal).toFixed(2);\n            console.log('grand total===>>', this.grandTotal);\n        }\n        this.util.setKeys('cart', JSON.stringify(this.cart));\n    }\n    checkProductInCart(id) {\n        return this.itemId.includes(id);\n    }\n    degreesToRadians(degrees) {\n        return degrees * Math.PI / 180;\n    }\n    distanceInKmBetweenEarthCoordinates(lat1, lon1, lat2, lon2) {\n        console.log(lat1, lon1, lat2, lon2);\n        const earthRadiusKm = 6371;\n        const dLat = this.degreesToRadians(lat2 - lat1);\n        const dLon = this.degreesToRadians(lon2 - lon1);\n        lat1 = this.degreesToRadians(lat1);\n        lat2 = this.degreesToRadians(lat2);\n        const a = Math.sin(dLat / 2) * Math.sin(dLat / 2) +\n            Math.sin(dLon / 2) * Math.sin(dLon / 2) * Math.cos(lat1) * Math.cos(lat2);\n        const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));\n        return earthRadiusKm * c;\n    }\n}\nCartService.ɵfac = function CartService_Factory(t) { return new (t || CartService)(i0.ɵɵinject(i1.UtilService)); };\nCartService.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: CartService, factory: CartService.ɵfac, providedIn: 'root' });\n"]},"metadata":{},"sourceType":"module"}